# Swagger


The [`SimpleW.Helper.Swagger`](https://www.nuget.org/packages/SimpleW.Helper.Swagger) package provides **Swagger / OpenAPI documentation** support for the SimpleW web server.

It automatically generates an **OpenAPI 3.0 specification** from the routes and handlers registered in SimpleW, and exposes a built-in Swagger UI for API exploration.

Swagger is exposed as a **helper**, not a module:
you decide **where**, **how**, and **under which** security rules it is served.

This package works **without ASP.NET, without annotations**, and **without modifying the SimpleW core**.


## What this package does

`SimpleW.Helper.Swagger` allows you to :
- Generate an **OpenAPI 3.0 JSON document** automatically
- Infer **paths, HTTP methods, and parameters** from registered routes
- Detect **path parameters**
- Support **both controller-based** and **delegate-based** routes
- Serve a built-in **Swagger UI** directly from SimpleW
- Filter which routes appear in the documentation

It **does not** :
- require ASP.NET Core
- rely on Swagger attributes
- modify route definitions
- introduce background services or timers
- add external runtime dependencies


## Requirements

- .NET 8.0
- SimpleW (core server)

No external dependencies.


## Installation

```sh
$ dotnet add package SimpleW.Helper.Swagger --version 26.0.0-beta.20260202-1339
```


## Basic Usage

Minimal exemple

```csharp [Controller Based]
using System.Net;
using SimpleW;
using SimpleW.Helper.Swagger;

var server = new SimpleWServer(IPAddress.Any, 8080);

server.MapGet("/api/hello", (string name) => {
    return new { message = $"Hello {name}" };
});

// OpenAPI JSON
server.MapGet("/swagger.json", static (HttpSession session) => {
    return Swagger.Json(session);
});

// Swagger UI
server.MapGet("/swagger", static (HttpSession session) => {
    return Swagger.UI(session);
});

await server.RunAsync();
```

Nothing is registered automatically.
You explicitly choose **where Swagger lives**.


## Route discovery

The Swagger package automatically discovers routes from the SimpleW router.

Supported styles :
- `MapGet`, `MapPost`, `Map(method, path, handler)`
- Controller-based routing using `[Route]` attributes


## Path parameters

Path parameters are detected from route templates :

```csharp
server.MapGet("/api/users/:id", (int id) => {
    return new { id };
});
```

This produces :

```
GET /api/users/{id}
```

With `id` documented as a **path parameter**.


## Controller-based routes

Controllers are supported automatically.

```csharp
[Route("/api/users")]
public sealed class UsersController : Controller {

    [Route("GET", "/list")]
    public object List(int page = 1) {
        return new { page };
    }

}
```

The Swagger helper inspects controller methods via reflection and infers parameters from their signatures.


## Swagger UI

Swagger UI is returned explicitly by the helper.
There is **no default route and no fixed path**.

Example :

```csharp
server.MapGet("/swagger", static (HttpSession session) => {
    return Swagger.UI(session);
});
```

The UI uses a CDN-based Swagger UI distribution by default.
No static files are required.

You can override the UI HTML if needed :

```csharp
server.MapGet("/swagger", static (HttpSession session) => {
    return Swagger.UI(session, options => {
        options.UiHtmlFactory = jsonContent => $"<html>Custom UI for {jsonContent}</html>";
    });
});
```


## Configuration options

```csharp
Swagger.Json(session, options => {

    options.Title = "My API";
    options.Version = "v1";
    options.Description = "Public API documentation";

    // Only expose /api routes
    options.RouteFilter = r => r.Path.StartsWith("/api", StringComparison.Ordinal);
});
```

### Available options

| Option                         | Description                                         |
| ------------------------------ | --------------------------------------------------- |
| `Title`                        | OpenAPI document title                              |
| `Version`                      | OpenAPI version string                              |
| `Description`                  | Optional document description                       |
| `RouteFilter`                  | Predicate to filter visible routes                  |
| `ScanControllersForParameters` | Enable controller parameter inference               |
| `UiHtmlFactory`                | Custom Swagger UI HTML renderer                     |


## OpenAPI generation behavior

- OpenAPI version : **3.0.3**
- Responses :
  - `200` is generated by default
- Schemas :
  - Primitive parameter types are inferred when possible
  - Complex request/response schemas are not generated automatically (by design)

The goal is **accurate route documentation**, not full schema generation.


## Design philosophy

- No magic
- No annotations
- No ASP.NET dependency
- No impact on request handling
- Best-effort reflection, never required configuration

If the helper cannot infer something reliably, it simply omits it instead of guessing.


## What this module is NOT

This package intentionally does **not** :
- generate full DTO schemas
- replace a full OpenAPI authoring tool
- validate requests or responses
- enforce API contracts
- require Swagger attributes everywhere

It documents **what SimpleW actually routes**, nothing more.
